import{a as k,u as z,b as S,c as L,d as _,e as f,o as p,f as a,_ as O,t as w,r as b,F as D,g as I,h as x,n as T,w as E,v as V,i as U,s as B,j as g,k as r,l as y,m as Q,p as R,q as X,x as K,y as N,z as $,A as G,B as M,C as J,D as W,T as Y,E as Z,G as ee,H as P,I as te,J as oe,K as se,L as ne,M as ae,N as re}from"./index-C0WFbxMy.js";const ie={VITE_APP_BASEURL:"https://todolist-api.hexschool.io"},{VITE_APP_BASEURL:C}=ie,le=async()=>(await k.get(`${C}/todos`)).data,ue=e=>k.post(`${C}/todos`,{content:e}),de=e=>k.patch(`${C}/todos/${e}/toggle`),ce=async e=>(await k.delete(`${C}/todos/${e}`)).data,me=async({id:e,content:t})=>(console.log("editTodo",e,t),(await k.put(`${C}/todos/${e}`,{content:t})).data),pe=(e={})=>z({queryKey:["todo"],queryFn:le,enabled:e.enabled??!1,staleTime:1e3*60*5,cacheTime:1e3*60*30}),he=()=>{const e=S();return L({mutationFn:ue,onSuccess:()=>{e.invalidateQueries(["todos"])},onError:t=>{_("error",t.response.data.message||"新增失敗，請重試或是洽詢客服")}})},fe=()=>{const e=S();return L({mutationFn:ce,onSuccess:()=>{e.invalidateQueries(["todos"])},onError:t=>{_("error",t.response.data.message||"移除失敗，請重試或是洽詢客服")}})},ve=()=>{const e=S();return L({mutationFn:de,onSuccess:()=>{e.invalidateQueries(["todos"])},onError:t=>{_("error",t.response.data.message||"完成勾選失敗，請重試或是洽詢客服")}})},ge=()=>{const e=S();return L({mutationFn:me,onSuccess:()=>{e.invalidateQueries(["todos"])},onError:t=>{_("error",t.response.data.message||"編輯失敗，請重試或是洽詢客服")}})},ye={class:"w-full px-5"},be={class:"flex justify-between items-center"},_e={class:"flex"},we={class:"font-bold hidden sm:block me-6"},xe={__name:"DashBoardHeader",props:{userNickname:{type:String,required:!0}},emits:["sign_out"],setup(e,{emit:t}){const o=e,d=t,l=()=>{d("sign_out")};return(h,i)=>(p(),f("header",ye,[a("div",be,[i[0]||(i[0]=a("img",{src:O,alt:"logo",style:{width:"242.51px"}},null,-1)),a("div",_e,[a("h2",we,w(o.userNickname)+"的代辦",1),a("a",{role:"button",class:"hover:text-red-700",onClick:l},"登出")])])]))}},$e="/HS_vue_online_toolBox/empty%201.svg",ke={class:"font-normal py-4 flex flex-col gap-y-4"},Ce={key:0,class:"border-b-2 border-neutral-100 -mb-[2px] pb-4 flex items-center"},Te=["onClick"],Se=["onClick"],Le={class:"ms-auto flex items-center gap-x-2"},Ne=["onClick"],Me=["onClick"],Be={key:1,class:"flex items-center"},Ee=["onUpdate:modelValue"],Fe={class:"ms-auto flex items-center gap-x-2"},Ae=["onClick"],qe=["onClick"],He={key:1},Pe={__name:"TodoList",props:{mode:{type:String,default:"all"},todoList:{type:Array,required:!0}},setup(e){const t=e,{mutate:o}=fe(),d=s=>{U("warning","確定要刪除此代辦嗎").then(n=>{n.isConfirmed&&o(s,{onSuccess:()=>{B("success","刪除代辦成功")}})})},{mutate:l}=ve(),{mutate:h}=ge(),i=b({}),m=(s,n="")=>{i.value[s]?(i.value[s].isEditing=!i.value[s].isEditing,i.value[s].content=n):i.value[s]={isEditing:!0,content:n}},u=(s,n)=>{if(!n){_("error","請輸入代辦事項");return}h({id:s,content:n},{onSuccess:()=>{B("success","編輯成功"),m(s)}})};return(s,n)=>(p(),f("ul",ke,[e.todoList.length?(p(!0),f(D,{key:0},I(t.todoList,c=>(p(),f("li",{key:c.id},[i.value[c.id]?.isEditing?(p(),f("div",Be,[E(a("input",{type:"text",class:"bg-neutral-100 text-neutral-500 leading-none border-b-1 border-neutral-300 rounded-[10px] focus:ring-neutral-500 focus:border-neutral-500 block w-[80%] py-2 ps-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500","onUpdate:modelValue":v=>i.value[c.id].content=v},null,8,Ee),[[V,i.value[c.id].content]]),a("div",Fe,[a("button",{type:"button",onClick:v=>m(c.id)},[...n[4]||(n[4]=[a("span",{class:"material-symbols-outlined close-icon text-alert-500"}," close ",-1)])],8,Ae),a("button",{type:"button",onClick:v=>u(c.id,i.value[c.id].content)},[...n[5]||(n[5]=[a("span",{class:"material-symbols-outlined circle-icon text-lime-600"}," circle ",-1)])],8,qe)])])):(p(),f("div",Ce,[c.status?(p(),f("button",{key:0,type:"button",onClick:v=>x(l)(c.id)},[...n[0]||(n[0]=[a("span",{class:"material-symbols-outlined check-icon text-primary-500 hover:text-alert-500"}," check ",-1)])],8,Te)):(p(),f("button",{key:1,type:"button",onClick:v=>x(l)(c.id)},[...n[1]||(n[1]=[a("span",{class:"material-symbols-outlined checkbox-icon text-neutral-300 hover:text-alert-500"}," check_box_outline_blank ",-1)])],8,Se)),a("p",{class:T(["ms-4",c.status?"text-neutral-300 line-through":""])},w(c.content),3),a("div",Le,[a("button",{type:"button",onClick:v=>m(c.id,c.content)},[...n[2]||(n[2]=[a("span",{class:"material-symbols-outlined edit-icon text-neutral-500 hover:text-alert-500"}," edit_square ",-1)])],8,Ne),a("button",{type:"button",onClick:v=>d(c.id)},[...n[3]||(n[3]=[a("span",{class:"material-symbols-outlined delete-icon text-neutral-500 hover:text-alert-500"}," delete ",-1)])],8,Me)])]))]))),128)):(p(),f("li",He,"目前並無"+w(e.mode==="isDone"?"已完成":"待完成")+"代辦事項",1))]))}},De={key:0,class:"bg-white text-sm rounded-[10px] px-4 pb-4 md:px-6 custom-drop-shadow"},Ie={class:"text-neutral-300 dark:text-gray-400 text-center font-bold flex flex-wrap -mx-4 -mb-[2px]"},Ve={class:"w-1/3"},Ue={class:"w-1/3"},je={class:"w-1/3"},ze={class:"py-2"},Oe={key:1,class:"w-2/3 mx-auto mt-8 flex flex-col lg:mt-12"},Qe={__name:"TodoBox",props:{todos:{type:Object}},setup(e){const t=e,o=b("all"),d=u=>{o.value=u},l=g(()=>{switch(o.value){case"isDone":return t.todos?.data.filter(u=>u.status)??[];case"undone":return t.todos?.data.filter(u=>!u.status)??[];default:return t.todos?.data??[]}}),h=g(()=>t.todos?.data.length??0),i=g(()=>t.todos?.data.filter(u=>!u.status).length??0),m=u=>({"block p-4 border-b-2":!0,"border-neutral-100 hover:border-gray-300":o.value!==u,"text-neutral-500 border-neutral-500":o.value===u});return(u,s)=>h.value!==0?(p(),f("div",De,[a("ul",Ie,[a("li",Ve,[a("a",{class:T(m("all")),onClick:s[0]||(s[0]=y(n=>d("all"),["prevent"]))},"全部",2)]),a("li",Ue,[a("a",{class:T(m("undone")),onClick:s[1]||(s[1]=y(n=>d("undone"),["prevent"])),"aria-current":"page"},"待完成",2)]),a("li",je,[a("a",{class:T(m("isDone")),onClick:s[2]||(s[2]=y(n=>d("isDone"),["prevent"]))},"已完成",2)])]),r(Pe,{mode:o.value,"todo-list":l.value},null,8,["mode","todo-list"]),a("p",ze,w(i.value)+" 個待完成項目",1)])):(p(),f("div",Oe,[...s[3]||(s[3]=[a("p",{class:"text-center mb-4"},"目前尚無待辦事項",-1),a("img",{src:$e,alt:"目前尚無待辦事項"},null,-1)])]))}},Re=3,j=Q("todoStore",()=>{const e=b([]);function t(o){e.value.length<Re?e.value.unshift(o):(e.value.unshift(o),e.value.pop())}return{historyTodos:e,saveHistoryTodos:t}}),Xe={key:0,class:"w-full absolute top-0 left-0 translate-y-[56px]"},Ke={class:"bg-white text-sm rounded-[10px] px-4 py-4 md:px-6 custom-drop-shadow"},Ge={class:"font-normal -mx-4 flex flex-col gap-y-2"},Je=["onMousedown"],We={__name:"TodoHistoryList",props:{isShowHistory:{type:Boolean,required:!0}},emits:["add-history"],setup(e,{emit:t}){const o=e,d=t,l=j(),{historyTodos:h}=R(l),i=m=>{d("add-history",m)};return(m,u)=>o.isShowHistory&&x(h).length>0?(p(),f("div",Xe,[a("div",Ke,[a("ul",Ge,[(p(!0),f(D,null,I(x(h),s=>(p(),f("li",{key:s,class:"px-3 py-2 flex items-center hover:bg-neutral-100",onMousedown:y(n=>i(s),["prevent"])},[u[0]||(u[0]=a("span",{class:"material-symbols-outlined me-4"}," history_2 ",-1)),K(" "+w(s),1)],40,Je))),128))])])])):X("",!0)}},Ye={__name:"TodoAddInput",setup(e){const t=b(""),{mutate:o}=he(),d=j(),{saveHistoryTodos:l}=d,h=s=>{if(!s){_("error","請輸入代辦事項");return}o(s,{onSuccess:()=>{l(s),B("success","新增成功"),t.value=""}})},i=b(!1),m=()=>{setTimeout(()=>{i.value=!1},150)},u=s=>{t.value=s,i.value=!1};return(s,n)=>(p(),f("form",{class:"relative",onSubmit:n[2]||(n[2]=y(c=>h(t.value),["prevent"]))},[E(a("input",{type:"text",id:"register_nickname",class:"bg-neutral-50 text-neutral-500 border-none rounded-[10px] focus:ring-neutral-500 focus:border-neutral-500 block w-full py-3 ps-4 custom-drop-shadow",placeholder:"新增待辦事項","onUpdate:modelValue":n[0]||(n[0]=c=>t.value=c),onFocus:n[1]||(n[1]=()=>i.value=!0),onBlur:m},null,544),[[V,t.value,void 0,{trim:!0}]]),n[3]||(n[3]=a("button",{type:"submit",class:"btn-square btn-neutral rounded-[10px] absolute bottom-0 right-0 -translate-[4px]"},[a("span",{class:"material-symbols-outlined add-icon"}," add ")],-1)),r(We,{"is-show-history":i.value,onAddHistory:u},null,8,["is-show-history"])],32))}};/**
 * Vue 3 Loading Overlay 0.0.0
 * (c) 2020
 * @license MIT
 */var F=N({name:"spinner",props:{color:{type:String,default:"#000"},height:{type:Number,default:64},width:{type:Number,default:64}}});const Ze=r("g",{fill:"none","fill-rule":"evenodd"},[r("g",{transform:"translate(1 1)","stroke-width":"2"},[r("circle",{"stroke-opacity":".25",cx:"18",cy:"18",r:"18"}),r("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[r("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.8s",repeatCount:"indefinite"})])])],-1);function et(e,t,o,d,l,h){return p(),$("svg",{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height,stroke:e.color},[Ze],8,["width","height","stroke"])}F.render=et;F.__file="src/loaders/Spinner.vue";var A=N({name:"dots",props:{color:{type:String,default:"#000"},height:{type:Number,default:240},width:{type:Number,default:60}}});const tt=r("circle",{cx:"15",cy:"15",r:"15"},[r("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),r("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})],-1),ot=r("circle",{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"},[r("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),r("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})],-1),st=r("circle",{cx:"105",cy:"15",r:"15"},[r("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),r("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})],-1);function nt(e,t,o,d,l,h){return p(),$("svg",{viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:e.color,width:e.width,height:e.height},[tt,ot,st],8,["fill","width","height"])}A.render=nt;A.__file="src/loaders/Dots.vue";var q=N({name:"bars",props:{color:{type:String,default:"#000"},height:{type:Number,default:40},width:{type:Number,default:40}}});const at=r("rect",{x:"0",y:"13",width:"4",height:"5"},[r("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}),r("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:"0.6s",repeatCount:"indefinite"})],-1),rt=r("rect",{x:"10",y:"13",width:"4",height:"5"},[r("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}),r("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"})],-1),it=r("rect",{x:"20",y:"13",width:"4",height:"5"},[r("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}),r("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"})],-1);function lt(e,t,o,d,l,h){return p(),$("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",height:e.height,width:e.width,fill:e.color},[at,rt,it],8,["height","width","fill"])}q.render=lt;q.__file="src/loaders/Bars.vue";var ut={Spinner:F,Dots:A,Bars:q},H=N({name:"vue-loading",props:{active:Boolean,programmatic:Boolean,container:[Object,Function,HTMLElement],isFullPage:{type:Boolean,default:!0},enforceFocus:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!1},transition:{type:String,default:"fade"},canCancel:Boolean,onCancel:{type:Function,default:()=>{}},color:String,backgroundColor:String,blur:{type:String,default:"2px"},opacity:Number,width:Number,height:Number,zIndex:{type:Number,default:100},loader:{type:String,default:"spinner"}},setup(e,t){const o=b(e.active),d=g(()=>({background:e.backgroundColor,opacity:e.opacity,backdropFilter:`blur(${e.blur})`})),l=()=>{e.programmatic&&(o.value=!1,setTimeout(()=>{},150))},h=()=>{!e.canCancel||!o.value||(l(),e.onCancel())},i=s=>{s.keyCode===27&&h()},m=()=>{e.isFullPage&&e.lockScroll&&document.body.classList.add("vld-shown")},u=()=>{e.isFullPage&&e.lockScroll&&document.body.classList.remove("vld-shown")};return Z(()=>{e.programmatic&&(o.value=!0,document.addEventListener("keyup",i))}),ee(()=>{document.removeEventListener("keyup",i)}),P(()=>e.active,()=>{o.value=e.active}),P(o,()=>{o.value?m():u()}),{isActive:o,bgStyle:d,hide:l,cancel:h}},components:ut});const dt={class:"vld-icon"};function ct(e,t,o,d,l,h){return p(),$(Y,{ref:"root",name:e.transition},{default:G(()=>[E(r("div",{tabindex:"0",class:["vld-overlay is-active",{"is-full-page":e.isFullPage}],"aria-busy":e.isActive,"aria-label":"Loading",style:{zIndex:e.zIndex}},[r("div",{class:"vld-background",onClick:t[1]||(t[1]=y((...i)=>e.cancel&&e.cancel(...i),["prevent"])),style:e.bgStyle},null,4),r("div",dt,[M(e.$slots,"before"),M(e.$slots,"default",{},()=>[(p(),$(J(e.loader),{color:e.color,width:e.width,height:e.height},null,8,["color","width","height"]))]),M(e.$slots,"after")])],14,["aria-busy"]),[[W,e.isActive]])]),_:3},8,["name"])}H.render=ct;H.__file="src/main/Component.vue";function mt(e,t,o){const d=te(e,t),l=document.createElement("div");return o.appendChild(l),oe(d,l),d.component}function pt(e){var t;typeof e.remove<"u"?e.remove():(t=e.parentNode)===null||t===void 0||t.removeChild(e)}function ht(e={},t={}){let o=null;return{show(l=e,h=t){const m=Object.assign({},e,l,{programmatic:!0,lockScroll:!0,isFullPage:!1});let u=m.container;m.container||(u=document.body,m.isFullPage=!0),o=mt(H,m,u);const s=Object.assign({},t,h);Object.keys(s).map(n=>{o!=null&&(o.slots[n]=s[n])})},hide(){if(o!=null){o.ctx.hide();let l=o.vnode.el;pt(l.parentElement)}}}}const ft={class:"sm:bg-linear-primary min-h-screen"},vt={class:"mx-auto px-3 pt-4"},gt={class:"w-full sm:w-2/3 lg:w-1/2 mx-auto mt-4 sm:mt-10 px-5"},yt={class:"mt-4"},_t={__name:"TodoListView",setup(e){const{data:t}=se(),{mutate:o}=ne(),d=re(),l=()=>{U("warning","確定要登出嗎").then(c=>{c.isConfirmed&&o(void 0,{onSuccess:()=>{d.push("/login")}})})},h=g(()=>t.value?.status??!1),i=g(()=>t.value?.nickname??""),{data:m,isLoading:u,isFetching:s}=pe({enabled:h});let n=ht({color:"#ffd370",loader:"spinner",width:64,height:64,backgroundColor:"#ffffff",opacity:.5,zIndex:999});return ae(()=>{if(u.value||s.value)n.show();else try{n.hide()}catch(c){console.warn("Hide failed:",c)}}),(c,v)=>(p(),f("div",ft,[a("div",vt,[r(xe,{"user-nickname":i.value,onSign_out:l},null,8,["user-nickname"]),a("div",gt,[r(Ye),a("div",yt,[r(Qe,{todos:x(m)},null,8,["todos"])])])])]))}};export{_t as default};
